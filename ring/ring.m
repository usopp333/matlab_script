clc
clear all
pi = 3.1415926;
R2 = 20;
R1 = R2-0.7;
% R3 = 2;
w2 = 0.46;
w1 = 0.534;
wg_h = 0.22;
ldc0 = 4.5;
theta_span = 180;%dc在外圆环上的范围角
% te tm 在两种结构的波导中的neff
te_w2_neff = 2.310798;
te_w1_neff = 2.433812;
tm_w2_neff = 1.594099;
tm_w1_neff = 1.641671;

L_te_w2 = 2*pi*R2*te_w2_neff; %te 模式在外圆环中的光程

d_L_tetm = (L_te_w2 - tm_w2_neff*(R2*(2*pi-pi*theta_span/180+ldc0/R1)+ldc0))/tm_w1_neff;
    
% R4*(2*pi-(pi*theta_span/180-2*ldc0/R1))+2*pi*R3 = d_L_tetm-ldc0;
% R4+2*R3 = R1;
%d_L_R4 = d_L_tetm - 2*pi*R3 - ldc0;
R3 = (d_L_tetm-ldc0-R1*(2*pi-pi*theta_span/180+2*ldc0/R1))/(2*pi-2*(2*pi-(pi*theta_span/180-2*ldc0/R1)));
R4 = R1 - 2*R3;


x1 = [1.525000e+000, 1.526000e+000, 1.527000e+000, 1.528000e+000, 1.529000e+000, 1.530000e+000, 1.531000e+000, 1.532000e+000, 1.533000e+000, 1.534000e+000, 1.535000e+000, 1.536000e+000, 1.537000e+000, 1.538000e+000, 1.539000e+000, 1.540000e+000, 1.541000e+000, 1.542000e+000, 1.543000e+000, 1.544000e+000, 1.545000e+000, 1.546000e+000, 1.547000e+000, 1.548000e+000, 1.549000e+000, 1.550000e+000, 1.551000e+000, 1.552000e+000, 1.553000e+000, 1.554000e+000, 1.555000e+000, 1.556000e+000, 1.557000e+000, 1.558000e+000, 1.559000e+000, 1.560000e+000, 1.561000e+000, 1.562000e+000, 1.563000e+000, 1.564000e+000, 1.565000e+000, 1.566000e+000, 1.567000e+000, 1.568000e+000, 1.569000e+000, 1.570000e+000, 1.571000e+000, 1.572000e+000, 1.573000e+000, 1.574000e+000];
% Total Pz - T(Abs^2) ((1e0)) (1-50)
d1 = [4.873791e-001, 5.047810e-001, 6.733861e-001, 3.225422e-001, 2.281757e-001, 3.834907e-001, 3.716656e-001, 2.652809e-001, 3.847102e-001, 5.469212e-001, 4.613612e-001, 6.139613e-001, 5.824914e-001, 3.511460e-001, 3.657620e-001, 5.861707e-001, 2.515643e-001, 1.750757e-001, 3.549610e-001, 5.574941e-001, 4.419615e-001, 5.549588e-001, 5.564718e-001, 3.692926e-001, 4.278792e-001, 7.040934e-001, 2.967031e-001, 1.868872e-001, 3.129935e-001, 4.970151e-001, 3.355151e-001, 3.644679e-001, 4.958754e-001, 4.333708e-001, 4.171138e-001, 6.714516e-001, 3.811941e-001, 2.235865e-001, 3.187515e-001, 6.424028e-001, 2.919548e-001, 1.968170e-001, 3.254213e-001, 5.047524e-001, 3.833504e-001, 4.779559e-001, 5.147821e-001, 2.610054e-001, 0.000000e+000, 0.000000e+000];
% Lambda (1-50)
x2 = [1.525000e+000, 1.526000e+000, 1.527000e+000, 1.528000e+000, 1.529000e+000, 1.530000e+000, 1.531000e+000, 1.532000e+000, 1.533000e+000, 1.534000e+000, 1.535000e+000, 1.536000e+000, 1.537000e+000, 1.538000e+000, 1.539000e+000, 1.540000e+000, 1.541000e+000, 1.542000e+000, 1.543000e+000, 1.544000e+000, 1.545000e+000, 1.546000e+000, 1.547000e+000, 1.548000e+000, 1.549000e+000, 1.550000e+000, 1.551000e+000, 1.552000e+000, 1.553000e+000, 1.554000e+000, 1.555000e+000, 1.556000e+000, 1.557000e+000, 1.558000e+000, 1.559000e+000, 1.560000e+000, 1.561000e+000, 1.562000e+000, 1.563000e+000, 1.564000e+000, 1.565000e+000, 1.566000e+000, 1.567000e+000, 1.568000e+000, 1.569000e+000, 1.570000e+000, 1.571000e+000, 1.572000e+000, 1.573000e+000, 1.574000e+000];
% Total Pz - T(Abs^2) ((1e0)) (1-50)
d2 = [3.410752e-001, 3.916895e-001, 3.229023e-001, 2.193816e-001, 1.730822e-001, 1.770132e-001, 2.345962e-001, 3.633175e-001, 4.651538e-001, 4.002301e-001, 3.111235e-001, 2.804315e-001, 3.146079e-001, 4.381784e-001, 6.720626e-001, 7.463857e-001, 5.144785e-001, 3.433327e-001, 2.765703e-001, 2.770541e-001, 3.363252e-001, 4.350579e-001, 4.230651e-001, 2.875580e-001, 2.007255e-001, 1.720199e-001, 1.879363e-001, 2.537601e-001, 3.487621e-001, 3.674543e-001, 2.873359e-001, 2.267722e-001, 2.205108e-001, 2.726725e-001, 4.131109e-001, 6.077773e-001, 5.559140e-001, 3.674750e-001, 2.665024e-001, 2.396842e-001, 2.706668e-001, 3.792044e-001, 5.815348e-001, 6.122708e-001, 3.895037e-001, 2.501111e-001, 2.011406e-001, 2.096612e-001, 0.000000e+000, 0.000000e+000];
figure;
plot(x1, d1,x2,d2);
xlabel('Lambda');
ylabel('Total Pz');
legend('tm outcouple','tm');
title('不同的位置');

% Lambda (1-50)
x3 = [1.525000e+000, 1.526000e+000, 1.527000e+000, 1.528000e+000, 1.529000e+000, 1.530000e+000, 1.531000e+000, 1.532000e+000, 1.533000e+000, 1.534000e+000, 1.535000e+000, 1.536000e+000, 1.537000e+000, 1.538000e+000, 1.539000e+000, 1.540000e+000, 1.541000e+000, 1.542000e+000, 1.543000e+000, 1.544000e+000, 1.545000e+000, 1.546000e+000, 1.547000e+000, 1.548000e+000, 1.549000e+000, 1.550000e+000, 1.551000e+000, 1.552000e+000, 1.553000e+000, 1.554000e+000, 1.555000e+000, 1.556000e+000, 1.557000e+000, 1.558000e+000, 1.559000e+000, 1.560000e+000, 1.561000e+000, 1.562000e+000, 1.563000e+000, 1.564000e+000, 1.565000e+000, 1.566000e+000, 1.567000e+000, 1.568000e+000, 1.569000e+000, 1.570000e+000, 1.571000e+000, 1.572000e+000, 1.573000e+000, 1.574000e+000];
% Total Pz - T(Abs^2) ((1e0)) (1-50)
d3 = [9.192587e-003, 1.595850e-002, 8.454854e-002, 6.608224e-002, 1.378274e-002, 8.487708e-003, 1.071604e-002, 3.275433e-002, 1.612776e-001, 2.177165e-002, 9.621149e-003, 9.622872e-003, 1.742339e-002, 7.864838e-002, 7.130326e-002, 1.757504e-002, 1.174727e-002, 1.630134e-002, 5.867184e-002, 4.756394e-002, 3.334013e-002, 1.335482e-002, 1.259994e-002, 2.268602e-002, 8.048055e-002, 7.464130e-002, 2.135287e-002, 1.333060e-002, 1.493486e-002, 3.543711e-002, 1.695544e-001, 4.544496e-002, 1.755708e-002, 1.534518e-002, 2.480639e-002, 9.769904e-002, 1.335713e-001, 2.932239e-002, 1.853345e-002, 2.285900e-002, 4.278292e-002, 5.589862e-002, 8.818830e-002, 3.372229e-002, 2.063857e-002, 2.340111e-002, 6.591967e-002, 1.810467e-001, 0.000000e+000, 0.000000e+000];
% Lambda (1-50)
x4 = [1.525000e+000, 1.526000e+000, 1.527000e+000, 1.528000e+000, 1.529000e+000, 1.530000e+000, 1.531000e+000, 1.532000e+000, 1.533000e+000, 1.534000e+000, 1.535000e+000, 1.536000e+000, 1.537000e+000, 1.538000e+000, 1.539000e+000, 1.540000e+000, 1.541000e+000, 1.542000e+000, 1.543000e+000, 1.544000e+000, 1.545000e+000, 1.546000e+000, 1.547000e+000, 1.548000e+000, 1.549000e+000, 1.550000e+000, 1.551000e+000, 1.552000e+000, 1.553000e+000, 1.554000e+000, 1.555000e+000, 1.556000e+000, 1.557000e+000, 1.558000e+000, 1.559000e+000, 1.560000e+000, 1.561000e+000, 1.562000e+000, 1.563000e+000, 1.564000e+000, 1.565000e+000, 1.566000e+000, 1.567000e+000, 1.568000e+000, 1.569000e+000, 1.570000e+000, 1.571000e+000, 1.572000e+000, 1.573000e+000, 1.574000e+000];
% Total Pz - T(Abs^2) ((1e0)) (1-50)
d4 = [1.032543e-002, 1.023492e-002, 3.943108e-002, 5.508589e-002, 1.391309e-002, 1.132799e-002, 2.544420e-002, 1.663038e-001, 2.052813e-002, 1.053704e-002, 1.744033e-002, 1.206001e-001, 3.352562e-002, 1.095345e-002, 1.310164e-002, 6.170857e-002, 7.619770e-002, 1.526238e-002, 1.513147e-002, 3.832840e-002, 3.720096e-002, 3.465601e-002, 1.396113e-002, 1.919264e-002, 9.065816e-002, 5.786635e-002, 1.477362e-002, 1.438465e-002, 4.751392e-002, 1.418728e-001, 2.680701e-002, 1.726288e-002, 2.692949e-002, 1.859578e-001, 5.291863e-002, 1.771959e-002, 1.950795e-002, 8.267051e-002, 7.806585e-002, 3.057462e-002, 1.784345e-002, 3.080607e-002, 1.384788e-001, 9.051004e-002, 2.376504e-002, 2.212461e-002, 5.213864e-002, 2.386150e-001, 0.000000e+000, 0.000000e+000];
% visualization 
figure;
plot(x3, d3,x4,d4);
xlabel('Lambda');
ylabel('Total Pz');
legend('te','te outcouple');




close all
x1 = [1.525000e+000, 1.525500e+000, 1.526000e+000, 1.526500e+000, 1.527000e+000, 1.527500e+000, 1.528000e+000, 1.528500e+000, 1.529000e+000, 1.529500e+000, 1.530000e+000, 1.530500e+000, 1.531000e+000, 1.531500e+000, 1.532000e+000, 1.532500e+000, 1.533000e+000, 1.533500e+000, 1.534000e+000, 1.534500e+000, 1.535000e+000, 1.535500e+000, 1.536000e+000, 1.536500e+000, 1.537000e+000, 1.537500e+000, 1.538000e+000, 1.538500e+000, 1.539000e+000, 1.539500e+000, 1.540000e+000, 1.540500e+000, 1.541000e+000, 1.541500e+000, 1.542000e+000, 1.542500e+000, 1.543000e+000, 1.543500e+000, 1.544000e+000, 1.544500e+000, 1.545000e+000, 1.545500e+000, 1.546000e+000, 1.546500e+000, 1.547000e+000, 1.547500e+000, 1.548000e+000, 1.548500e+000, 1.549000e+000, 1.549500e+000, 1.550000e+000, 1.550500e+000, 1.551000e+000, 1.551500e+000, 1.552000e+000, 1.552500e+000, 1.553000e+000, 1.553500e+000, 1.554000e+000, 1.554500e+000, 1.555000e+000, 1.555500e+000, 1.556000e+000, 1.556500e+000, 1.557000e+000, 1.557500e+000, 1.558000e+000, 1.558500e+000, 1.559000e+000, 1.559500e+000, 1.560000e+000, 1.560500e+000, 1.561000e+000, 1.561500e+000, 1.562000e+000, 1.562500e+000, 1.563000e+000, 1.563500e+000, 1.564000e+000, 1.564500e+000, 1.565000e+000, 1.565500e+000, 1.566000e+000, 1.566500e+000, 1.567000e+000, 1.567500e+000, 1.568000e+000, 1.568500e+000, 1.569000e+000, 1.569500e+000, 1.570000e+000, 1.570500e+000, 1.571000e+000, 1.571500e+000, 1.572000e+000, 1.572500e+000, 1.573000e+000, 1.573500e+000, 1.574000e+000, 1.574500e+000];

% Total Pz - T(Abs^2) ((1e0)) (1-100)
d1 = [6.501810e-002, 2.091215e-002, 1.240047e-002, 1.006776e-002, 1.094449e-002, 1.540740e-002, 3.471770e-002, 1.954523e-001, 2.664406e-001, 3.967816e-002, 1.746781e-002, 1.209128e-002, 1.096261e-002, 1.320827e-002, 2.119967e-002, 6.078642e-002, 5.019948e-001, 1.152587e-001, 2.787572e-002, 1.490983e-002, 1.113820e-002, 1.132147e-002, 1.458823e-002, 2.769848e-002, 1.025899e-001, 3.826396e-001, 8.092178e-002, 2.584121e-002, 1.493088e-002, 1.219895e-002, 1.284317e-002, 1.806324e-002, 3.757552e-002, 1.771334e-001, 4.450784e-001, 6.210333e-002, 2.407270e-002, 1.549129e-002, 1.334652e-002, 1.492691e-002, 2.201800e-002, 4.971459e-002, 2.587385e-001, 2.808965e-001, 5.139640e-002, 2.276632e-002, 1.525682e-002, 1.374897e-002, 1.556477e-002, 2.390008e-002, 5.546051e-002, 3.356145e-001, 3.077546e-001, 5.445256e-002, 2.446046e-002, 1.669373e-002, 1.519035e-002, 1.752652e-002, 2.704688e-002, 6.336475e-002, 3.566942e-001, 3.058244e-001, 5.874147e-002, 2.669389e-002, 1.832297e-002, 1.641346e-002, 1.878250e-002, 2.828805e-002, 6.416447e-002, 3.352515e-001, 3.371913e-001, 6.633157e-002, 2.977273e-002, 2.008083e-002, 1.772561e-002, 1.991403e-002, 2.912341e-002, 6.303798e-002, 3.024906e-001, 4.606627e-001, 7.882038e-002, 3.367555e-002, 2.209249e-002, 1.919648e-002, 2.099186e-002, 2.950035e-002, 5.875628e-002, 2.244769e-001, 6.445377e-001, 1.122386e-001, 4.217848e-002, 2.567847e-002, 2.097862e-002, 2.159173e-002, 2.845931e-002, 5.112733e-002, 1.566885e-001, 6.714731e-001, 1.739276e-001, 5.565242e-002];

x2 = [1.525000e+000, 1.525500e+000, 1.526000e+000, 1.526500e+000, 1.527000e+000, 1.527500e+000, 1.528000e+000, 1.528500e+000, 1.529000e+000, 1.529500e+000, 1.530000e+000, 1.530500e+000, 1.531000e+000, 1.531500e+000, 1.532000e+000, 1.532500e+000, 1.533000e+000, 1.533500e+000, 1.534000e+000, 1.534500e+000, 1.535000e+000, 1.535500e+000, 1.536000e+000, 1.536500e+000, 1.537000e+000, 1.537500e+000, 1.538000e+000, 1.538500e+000, 1.539000e+000, 1.539500e+000, 1.540000e+000, 1.540500e+000, 1.541000e+000, 1.541500e+000, 1.542000e+000, 1.542500e+000, 1.543000e+000, 1.543500e+000, 1.544000e+000, 1.544500e+000, 1.545000e+000, 1.545500e+000, 1.546000e+000, 1.546500e+000, 1.547000e+000, 1.547500e+000, 1.548000e+000, 1.548500e+000, 1.549000e+000, 1.549500e+000, 1.550000e+000, 1.550500e+000, 1.551000e+000, 1.551500e+000, 1.552000e+000, 1.552500e+000, 1.553000e+000, 1.553500e+000, 1.554000e+000, 1.554500e+000, 1.555000e+000, 1.555500e+000, 1.556000e+000, 1.556500e+000, 1.557000e+000, 1.557500e+000, 1.558000e+000, 1.558500e+000, 1.559000e+000, 1.559500e+000, 1.560000e+000, 1.560500e+000, 1.561000e+000, 1.561500e+000, 1.562000e+000, 1.562500e+000, 1.563000e+000, 1.563500e+000, 1.564000e+000, 1.564500e+000, 1.565000e+000, 1.565500e+000, 1.566000e+000, 1.566500e+000, 1.567000e+000, 1.567500e+000, 1.568000e+000, 1.568500e+000, 1.569000e+000, 1.569500e+000, 1.570000e+000, 1.570500e+000, 1.571000e+000, 1.571500e+000, 1.572000e+000, 1.572500e+000, 1.573000e+000, 1.573500e+000, 1.574000e+000, 1.574500e+000];

% Total Pz - T(Abs^2) ((1e0)) (1-100)
d2 = [7.521086e-002, 2.121718e-002, 1.148204e-002, 8.809699e-003, 9.513666e-003, 1.393997e-002, 3.062680e-002, 1.551609e-001, 2.089551e-001, 3.348388e-002, 1.545396e-002, 1.141990e-002, 1.001328e-002, 1.136841e-002, 1.755230e-002, 4.277030e-002, 2.486781e-001, 1.590762e-001, 3.236865e-002, 1.558947e-002, 1.120675e-002, 1.067124e-002, 1.345500e-002, 2.425108e-002, 8.004987e-002, 3.595108e-001, 8.311895e-002, 2.444871e-002, 1.368134e-002, 1.083731e-002, 1.094216e-002, 1.445893e-002, 2.725221e-002, 9.960016e-002, 3.171216e-001, 6.420046e-002, 2.280388e-002, 1.433470e-002, 1.199173e-002, 1.296656e-002, 1.848366e-002, 3.797727e-002, 1.633795e-001, 4.198120e-001, 6.330740e-002, 2.496298e-002, 1.600865e-002, 1.369461e-002, 1.512491e-002, 2.244729e-002, 4.841350e-002, 1.907094e-001, 2.217497e-001, 5.949722e-002, 2.464257e-002, 1.599104e-002, 1.364584e-002, 1.445568e-002, 1.960761e-002, 4.095843e-002, 1.671424e-001, 3.962158e-001, 7.015064e-002, 2.827590e-002, 1.824726e-002, 1.576313e-002, 1.739915e-002, 2.511071e-002, 5.314105e-002, 2.398838e-001, 4.093513e-001, 7.266322e-002, 3.067299e-002, 1.996865e-002, 1.722225e-002, 1.910074e-002, 2.749247e-002, 5.321234e-002, 1.389360e-001, 2.614045e-001, 9.938803e-002, 3.898012e-002, 2.379713e-002, 1.967604e-002, 2.036054e-002, 2.491601e-002, 4.092331e-002, 1.284878e-001, 5.478015e-001, 1.521248e-001, 5.088843e-002, 2.887972e-002, 2.237759e-002, 2.216209e-002, 2.807005e-002, 4.779572e-002, 1.315227e-001, 6.003922e-001, 1.737155e-001, 5.235294e-002];

x3 = [1.525000e+000, 1.525500e+000, 1.526000e+000, 1.526500e+000, 1.527000e+000, 1.527500e+000, 1.528000e+000, 1.528500e+000, 1.529000e+000, 1.529500e+000, 1.530000e+000, 1.530500e+000, 1.531000e+000, 1.531500e+000, 1.532000e+000, 1.532500e+000, 1.533000e+000, 1.533500e+000, 1.534000e+000, 1.534500e+000, 1.535000e+000, 1.535500e+000, 1.536000e+000, 1.536500e+000, 1.537000e+000, 1.537500e+000, 1.538000e+000, 1.538500e+000, 1.539000e+000, 1.539500e+000, 1.540000e+000, 1.540500e+000, 1.541000e+000, 1.541500e+000, 1.542000e+000, 1.542500e+000, 1.543000e+000, 1.543500e+000, 1.544000e+000, 1.544500e+000, 1.545000e+000, 1.545500e+000, 1.546000e+000, 1.546500e+000, 1.547000e+000, 1.547500e+000, 1.548000e+000, 1.548500e+000, 1.549000e+000, 1.549500e+000, 1.550000e+000, 1.550500e+000, 1.551000e+000, 1.551500e+000, 1.552000e+000, 1.552500e+000, 1.553000e+000, 1.553500e+000, 1.554000e+000, 1.554500e+000, 1.555000e+000, 1.555500e+000, 1.556000e+000, 1.556500e+000, 1.557000e+000, 1.557500e+000, 1.558000e+000, 1.558500e+000, 1.559000e+000, 1.559500e+000, 1.560000e+000, 1.560500e+000, 1.561000e+000, 1.561500e+000, 1.562000e+000, 1.562500e+000, 1.563000e+000, 1.563500e+000, 1.564000e+000, 1.564500e+000, 1.565000e+000, 1.565500e+000, 1.566000e+000, 1.566500e+000, 1.567000e+000, 1.567500e+000, 1.568000e+000, 1.568500e+000, 1.569000e+000, 1.569500e+000, 1.570000e+000, 1.570500e+000, 1.571000e+000, 1.571500e+000, 1.572000e+000, 1.572500e+000, 1.573000e+000, 1.573500e+000, 1.574000e+000, 1.574500e+000];

% Total Pz - T(Abs^2) ((1e0)) (1-100)
d3 = [8.416328e-002, 2.334523e-002, 1.295754e-002, 1.025219e-002, 1.101112e-002, 1.664708e-002, 3.544452e-002, 1.685448e-001, 2.643121e-001, 3.932079e-002, 1.737984e-002, 1.362774e-002, 1.215638e-002, 1.343838e-002, 2.052209e-002, 5.304352e-002, 2.700967e-001, 1.592971e-001, 4.141472e-002, 1.887209e-002, 1.297542e-002, 1.202903e-002, 1.493798e-002, 2.647995e-002, 8.374316e-002, 3.752014e-001, 9.879121e-002, 2.855154e-002, 1.556200e-002, 1.200261e-002, 1.244753e-002, 1.838976e-002, 3.550475e-002, 1.203662e-001, 2.879659e-001, 7.270590e-002, 2.585767e-002, 1.584090e-002, 1.403894e-002, 1.464027e-002, 1.953540e-002, 3.799420e-002, 1.503517e-001, 3.858276e-001, 7.025161e-002, 2.708140e-002, 1.674524e-002, 1.405706e-002, 1.543001e-002, 2.271635e-002, 5.109159e-002, 2.587710e-001, 2.911696e-001, 6.058777e-002, 2.716258e-002, 1.824089e-002, 1.612713e-002, 1.815488e-002, 2.717414e-002, 5.648692e-002, 1.976641e-001, 3.573030e-001, 7.950033e-002, 3.399287e-002, 2.255095e-002, 1.957049e-002, 1.984038e-002, 2.646358e-002, 5.325590e-002, 2.140382e-001, 4.594061e-001, 8.241716e-002, 3.246704e-002, 2.029632e-002, 1.765207e-002, 1.964636e-002, 2.839178e-002, 6.046734e-002, 2.478913e-001, 3.533311e-001, 8.749041e-002, 4.159236e-002, 2.652410e-002, 2.218645e-002, 2.387013e-002, 3.336040e-002, 6.048871e-002, 1.335942e-001, 4.113318e-001, 1.759743e-001, 5.616483e-002, 3.123491e-002, 2.396594e-002, 2.303958e-002, 2.684388e-002, 4.372476e-002, 1.194427e-001, 5.564062e-001, 2.042789e-001, 5.886105e-002];


figure;
plot(x1, d1,x2,d2,x3,d3);
xlabel('Lambda');
ylabel('Total Pz');
legend('te only ring','te add tm couple','te out couple');
title('TE模式各个ring中的谱线');
% Lambda (1-100)
x4 = [1.525000e+000, 1.525500e+000, 1.526000e+000, 1.526500e+000, 1.527000e+000, 1.527500e+000, 1.528000e+000, 1.528500e+000, 1.529000e+000, 1.529500e+000, 1.530000e+000, 1.530500e+000, 1.531000e+000, 1.531500e+000, 1.532000e+000, 1.532500e+000, 1.533000e+000, 1.533500e+000, 1.534000e+000, 1.534500e+000, 1.535000e+000, 1.535500e+000, 1.536000e+000, 1.536500e+000, 1.537000e+000, 1.537500e+000, 1.538000e+000, 1.538500e+000, 1.539000e+000, 1.539500e+000, 1.540000e+000, 1.540500e+000, 1.541000e+000, 1.541500e+000, 1.542000e+000, 1.542500e+000, 1.543000e+000, 1.543500e+000, 1.544000e+000, 1.544500e+000, 1.545000e+000, 1.545500e+000, 1.546000e+000, 1.546500e+000, 1.547000e+000, 1.547500e+000, 1.548000e+000, 1.548500e+000, 1.549000e+000, 1.549500e+000, 1.550000e+000, 1.550500e+000, 1.551000e+000, 1.551500e+000, 1.552000e+000, 1.552500e+000, 1.553000e+000, 1.553500e+000, 1.554000e+000, 1.554500e+000, 1.555000e+000, 1.555500e+000, 1.556000e+000, 1.556500e+000, 1.557000e+000, 1.557500e+000, 1.558000e+000, 1.558500e+000, 1.559000e+000, 1.559500e+000, 1.560000e+000, 1.560500e+000, 1.561000e+000, 1.561500e+000, 1.562000e+000, 1.562500e+000, 1.563000e+000, 1.563500e+000, 1.564000e+000, 1.564500e+000, 1.565000e+000, 1.565500e+000, 1.566000e+000, 1.566500e+000, 1.567000e+000, 1.567500e+000, 1.568000e+000, 1.568500e+000, 1.569000e+000, 1.569500e+000, 1.570000e+000, 1.570500e+000, 1.571000e+000, 1.571500e+000, 1.572000e+000, 1.572500e+000, 1.573000e+000, 1.573500e+000, 1.574000e+000, 1.574500e+000];

% Total Pz - T(Abs^2) ((1e0)) (1-100)
d4 = [5.143195e-001, 4.034910e-001, 2.971769e-001, 2.448697e-001, 2.659102e-001, 3.467952e-001, 4.467887e-001, 5.180600e-001, 5.447014e-001, 5.642031e-001, 6.302373e-001, 7.440538e-001, 8.377409e-001, 8.434255e-001, 7.731862e-001, 7.110559e-001, 7.201220e-001, 7.717359e-001, 7.783153e-001, 6.893220e-001, 5.427392e-001, 4.246102e-001, 3.912850e-001, 4.331481e-001, 4.979520e-001, 5.349935e-001, 5.241054e-001, 4.831571e-001, 4.568120e-001, 4.855562e-001, 5.689953e-001, 6.591885e-001, 7.028506e-001, 6.965379e-001, 6.920203e-001, 7.371633e-001, 8.146327e-001, 8.512790e-001, 7.938877e-001, 6.693768e-001, 5.624790e-001, 5.349518e-001, 5.714561e-001, 6.020035e-001, 5.690001e-001, 4.719897e-001, 3.606244e-001, 2.969441e-001, 3.183551e-001, 4.157572e-001, 5.346116e-001, 6.081990e-001, 6.112810e-001, 5.879783e-001, 6.132262e-001, 7.125350e-001, 8.229860e-001, 8.482173e-001, 7.588567e-001, 6.311995e-001, 5.769502e-001, 6.341131e-001, 7.311435e-001, 7.574661e-001, 6.649515e-001, 5.044129e-001, 3.758027e-001, 3.501625e-001, 4.272330e-001, 5.458769e-001, 6.267678e-001, 6.216355e-001, 5.464175e-001, 4.743494e-001, 4.814747e-001, 5.795307e-001, 6.986522e-001, 7.470023e-001, 6.979899e-001, 6.177976e-001, 6.008640e-001, 6.748275e-001, 7.703120e-001, 7.855246e-001, 6.811955e-001, 5.157716e-001, 3.940627e-001, 3.825629e-001, 4.642889e-001, 5.604827e-001, 5.912123e-001, 5.284903e-001, 4.122690e-001, 3.244637e-001, 3.352954e-001, 4.514625e-001, 6.033810e-001, 6.913707e-001, 6.651764e-001, 5.717031e-001];

% visualization 
figure;
plot(x3, d3,x4,d4);
xlabel('Lambda');
ylabel('Total Pz');
legend('te out couple','tm out couple');
title('te tm out couple 谱线');
x5 = [1.525000e+000, 1.525500e+000, 1.526000e+000, 1.526500e+000, 1.527000e+000, 1.527500e+000, 1.528000e+000, 1.528500e+000, 1.529000e+000, 1.529500e+000, 1.530000e+000, 1.530500e+000, 1.531000e+000, 1.531500e+000, 1.532000e+000, 1.532500e+000, 1.533000e+000, 1.533500e+000, 1.534000e+000, 1.534500e+000, 1.535000e+000, 1.535500e+000, 1.536000e+000, 1.536500e+000, 1.537000e+000, 1.537500e+000, 1.538000e+000, 1.538500e+000, 1.539000e+000, 1.539500e+000, 1.540000e+000, 1.540500e+000, 1.541000e+000, 1.541500e+000, 1.542000e+000, 1.542500e+000, 1.543000e+000, 1.543500e+000, 1.544000e+000, 1.544500e+000, 1.545000e+000, 1.545500e+000, 1.546000e+000, 1.546500e+000, 1.547000e+000, 1.547500e+000, 1.548000e+000, 1.548500e+000, 1.549000e+000, 1.549500e+000, 1.550000e+000, 1.550500e+000, 1.551000e+000, 1.551500e+000, 1.552000e+000, 1.552500e+000, 1.553000e+000, 1.553500e+000, 1.554000e+000, 1.554500e+000, 1.555000e+000, 1.555500e+000, 1.556000e+000, 1.556500e+000, 1.557000e+000, 1.557500e+000, 1.558000e+000, 1.558500e+000, 1.559000e+000, 1.559500e+000, 1.560000e+000, 1.560500e+000, 1.561000e+000, 1.561500e+000, 1.562000e+000, 1.562500e+000, 1.563000e+000, 1.563500e+000, 1.564000e+000, 1.564500e+000, 1.565000e+000, 1.565500e+000, 1.566000e+000, 1.566500e+000, 1.567000e+000, 1.567500e+000, 1.568000e+000, 1.568500e+000, 1.569000e+000, 1.569500e+000, 1.570000e+000, 1.570500e+000, 1.571000e+000, 1.571500e+000, 1.572000e+000, 1.572500e+000, 1.573000e+000, 1.573500e+000, 1.574000e+000, 1.574500e+000];
d5 = [1.737065e-001, 2.197753e-001, 2.193283e-001, 1.713945e-001, 1.200994e-001, 1.132431e-001, 1.558479e-001, 2.044560e-001, 2.097005e-001, 1.653685e-001, 1.142987e-001, 1.055162e-001, 1.465584e-001, 1.977213e-001, 2.109779e-001, 1.739454e-001, 1.190130e-001, 9.288309e-002, 1.156025e-001, 1.641764e-001, 1.937638e-001, 1.779495e-001, 1.325121e-001, 1.003611e-001, 1.107910e-001, 1.518332e-001, 1.825367e-001, 1.725583e-001, 1.299082e-001, 9.144850e-002, 8.817202e-002, 1.189027e-001, 1.537991e-001, 1.609044e-001, 1.321732e-001, 8.927157e-002, 6.562868e-002, 7.870158e-002, 1.148132e-001, 1.407129e-001, 1.333613e-001, 1.011037e-001, 7.558179e-002, 8.146237e-002, 1.130602e-001, 1.400365e-001, 1.359274e-001, 1.024590e-001, 6.834104e-002, 6.474093e-002, 9.842267e-002, 1.444382e-001, 1.651027e-001, 1.414804e-001, 9.142020e-002, 5.655163e-002, 6.674060e-002, 1.134213e-001, 1.568742e-001, 1.612072e-001, 1.245808e-001, 7.817505e-002, 5.781676e-002, 7.513449e-002, 1.110940e-001, 1.334163e-001, 1.223507e-001, 8.620941e-002, 5.566860e-002, 5.947122e-002, 9.896581e-002, 1.437920e-001, 1.559742e-001, 1.233403e-001, 7.150884e-002, 4.213859e-002, 5.712964e-002, 1.012570e-001, 1.371437e-001, 1.366705e-001, 1.014486e-001, 5.818919e-002, 3.634353e-002, 4.652636e-002, 7.463585e-002, 9.443452e-002, 8.875917e-002, 6.317810e-002, 4.096280e-002, 4.298103e-002, 6.939932e-002, 9.911187e-002, 1.073411e-001, 8.612207e-002, 5.070696e-002, 2.769218e-002, 3.500042e-002, 6.861914e-002, 1.049936e-001, 1.173743e-001];
x6 = [1.525000e+000, 1.525500e+000, 1.526000e+000, 1.526500e+000, 1.527000e+000, 1.527500e+000, 1.528000e+000, 1.528500e+000, 1.529000e+000, 1.529500e+000, 1.530000e+000, 1.530500e+000, 1.531000e+000, 1.531500e+000, 1.532000e+000, 1.532500e+000, 1.533000e+000, 1.533500e+000, 1.534000e+000, 1.534500e+000, 1.535000e+000, 1.535500e+000, 1.536000e+000, 1.536500e+000, 1.537000e+000, 1.537500e+000, 1.538000e+000, 1.538500e+000, 1.539000e+000, 1.539500e+000, 1.540000e+000, 1.540500e+000, 1.541000e+000, 1.541500e+000, 1.542000e+000, 1.542500e+000, 1.543000e+000, 1.543500e+000, 1.544000e+000, 1.544500e+000, 1.545000e+000, 1.545500e+000, 1.546000e+000, 1.546500e+000, 1.547000e+000, 1.547500e+000, 1.548000e+000, 1.548500e+000, 1.549000e+000, 1.549500e+000, 1.550000e+000, 1.550500e+000, 1.551000e+000, 1.551500e+000, 1.552000e+000, 1.552500e+000, 1.553000e+000, 1.553500e+000, 1.554000e+000, 1.554500e+000, 1.555000e+000, 1.555500e+000, 1.556000e+000, 1.556500e+000, 1.557000e+000, 1.557500e+000, 1.558000e+000, 1.558500e+000, 1.559000e+000, 1.559500e+000, 1.560000e+000, 1.560500e+000, 1.561000e+000, 1.561500e+000, 1.562000e+000, 1.562500e+000, 1.563000e+000, 1.563500e+000, 1.564000e+000, 1.564500e+000, 1.565000e+000, 1.565500e+000, 1.566000e+000, 1.566500e+000, 1.567000e+000, 1.567500e+000, 1.568000e+000, 1.568500e+000, 1.569000e+000, 1.569500e+000, 1.570000e+000, 1.570500e+000, 1.571000e+000, 1.571500e+000, 1.572000e+000, 1.572500e+000, 1.573000e+000, 1.573500e+000, 1.574000e+000, 1.574500e+000];

d6 = [3.837450e-001, 5.488598e-001, 7.180733e-001, 8.165189e-001, 8.127329e-001, 7.585127e-001, 7.364236e-001, 7.677011e-001, 7.904563e-001, 7.353757e-001, 6.060782e-001, 4.704202e-001, 3.838652e-001, 3.422237e-001, 3.092653e-001, 2.670318e-001, 2.271481e-001, 2.090252e-001, 2.268670e-001, 2.909455e-001, 3.970853e-001, 5.089975e-001, 5.735910e-001, 5.746606e-001, 5.634856e-001, 6.125508e-001, 7.312034e-001, 8.420261e-001, 8.544581e-001, 7.573404e-001, 6.275002e-001, 5.485866e-001, 5.334589e-001, 5.290970e-001, 4.836652e-001, 3.953408e-001, 3.008366e-001, 2.347401e-001, 2.079484e-001, 2.130803e-001, 2.341702e-001, 2.524455e-001, 2.600900e-001, 2.781187e-001, 3.483499e-001, 4.878836e-001, 6.494232e-001, 7.454653e-001, 7.291327e-001, 6.479261e-001, 6.017836e-001, 6.410984e-001, 7.139803e-001, 7.213086e-001, 6.182372e-001, 4.536015e-001, 3.141144e-001, 2.451612e-001, 2.295762e-001, 2.270369e-001, 2.154357e-001, 1.972193e-001, 1.878013e-001, 2.105055e-001, 2.884343e-001, 4.177131e-001, 5.464595e-001, 6.036878e-001, 5.699300e-001, 5.138822e-001, 5.360901e-001, 6.634823e-001, 8.080820e-001, 8.440512e-001, 7.281590e-001, 5.391393e-001, 3.996419e-001, 3.677041e-001, 4.040211e-001, 4.303440e-001, 4.039259e-001, 3.394289e-001, 2.795345e-001, 2.587586e-001, 2.872513e-001, 3.489405e-001, 4.069027e-001, 4.236632e-001, 3.950810e-001, 3.677480e-001, 4.078056e-001, 5.355377e-001, 6.882804e-001, 7.608950e-001, 6.976023e-001, 5.488540e-001, 4.325801e-001, 4.317254e-001, 5.244174e-001, 6.105530e-001];

figure;
plot(x3, d3,x5,d5,x6,d6);
xlabel('Lambda');
ylabel('Total Pz');
legend('te','tm theta_start','tm ');
title('te tm out couple 谱线');


%% 使用fdfd测试只有ring的Tm模式
% 改变gap的大小来实现谱线变窄；

x1 = [1.546000e+000, 1.546632e+000, 1.547263e+000, 1.547895e+000, 1.548526e+000, 1.549158e+000, 1.549789e+000, 1.550421e+000, 1.551053e+000, 1.551684e+000, 1.552316e+000, 1.552947e+000, 1.553579e+000, 1.554211e+000, 1.554842e+000, 1.555474e+000, 1.556105e+000, 1.556737e+000, 1.557368e+000, 1.558000e+000];

% drop_t - T(Abs^2) ((1e0)) (1-20)
d1 = [7.071516e-001, 6.748944e-001, 6.520473e-001, 6.407950e-001, 6.425260e-001, 6.570450e-001, 6.833713e-001, 7.187467e-001, 7.584052e-001, 7.942541e-001, 8.171015e-001, 8.188431e-001, 7.989819e-001, 7.630925e-001, 7.204026e-001, 6.796652e-001, 6.468836e-001, 6.262474e-001, 6.188857e-001, 6.253704e-001];

% visualization 
figure;
plot(x1, d1);
xlabel('lambda');
ylabel('drop_t');
legend('tm gap = 0.12');



